#!/usr/bin/env node

const run = require('../src/run');
const con = require('../src/constants');
const yargs = require('yargs');

const main = async () => {
    const verbosityChoices = Object.keys(con.VerbosityLevel);
    const browserChoices = Object.keys(con.BrowserMode);

    const argv = yargs
        .option('verbosity', { alias: 'v', default: 'advanced', choices: verbosityChoices })
        .option('browser', { alias: 'b', default: 'headless', choices: browserChoices })
        .option('threads', { alias: 't', default: false })
        .option('cwd', { alias: 'w', default: process.cwd() })
        .option('data', { alias: 'd', default: {} }).argv;

    const pattern = argv._[0] || './test/**/*.spec.js';
    await run({ pattern, ...argv });
    process.exit();
};

main();
